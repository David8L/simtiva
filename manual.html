<!DOCTYPE html>
<!-- VERSION 2.0 -->
<html lang="en" style="background:#222">
<head>
	<link rel="stylesheet" href="styles.css">
	<link rel="stylesheet" href="styles-manual.css">
	<link href="css/fontawesome.min.css" rel="stylesheet"> 
	<link href="css/regular.min.css" rel="stylesheet"> 
	<link href="css/solid.min.css" rel="stylesheet">
	<link href="css/brands.min.css" rel="stylesheet"> <!--font awesome-->
	<meta name="theme-color" content="#000000">
	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
	<link rel="apple-touch-icon" href="apple-touch-icon.png" />
	<link rel="apple-touch-icon" sizes="57x57" href="apple-touch-icon-57x57.png" />
	<link rel="apple-touch-icon" sizes="72x72" href="apple-touch-icon-72x72.png" />
	<link rel="apple-touch-icon" sizes="76x76" href="apple-touch-icon-76x76.png" />
	<link rel="apple-touch-icon" sizes="114x114" href="apple-touch-icon-114x114.png" />
	<link rel="apple-touch-icon" sizes="120x120" href="apple-touch-icon-120x120.png" />
	<link rel="apple-touch-icon" sizes="144x144" href="apple-touch-icon-144x144.png" />
	<link rel="apple-touch-icon" sizes="152x152" href="apple-touch-icon-152x152.png" />
	<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon-180x180.png" />

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <meta charset="utf-8">
	<meta name="description" content="Manual for SimTIVA: simple and free TIVA simulator">
    <meta name="keywords" content="simtiva, tiva, tci, free, simulator, calculator, terence, luk, propofol, remifentanil, alfentanil, app, smartphones, apple, android">
    <meta name="author" content="Terence Luk">
    <title>SimTIVA Manual</title>
</head>
<body style="">
	<div id="menu2">
						<div class="languagebutton" style="position:fixed;bottom:60px;left:calc(50% - 65px)" onclick="displayLanguagePanel();">
							<span><i class="fas fa-globe"></i></span>
							<span class="languagedescription">English</span>
							<span class="languagechevron"><i class="fas fa-chevron-down"></i></span>
						</div>
		<div class="menucontent">
		</div>
	</div>
	<div class="hamburgermanual" id="hamburgermanual" onclick="togglemenu2();">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
    </div>
    <div class="m-aside">
		<div class="m-header">
			<div class="m-header-left"></div>
			<div class="m-header-right"><div id="chapternum"></div><div id="chaptername">SimTIVA manual</div></div>
			<div class="m-header-close"></div>
		</div>
		<div class="m-subheader">
			<div class="m-subheader-icon">&nbsp;</div>
			<div class="m-subheader-left"></div>
			<div class="m-subheader-right"><span id="subheaderdropdown" onclick="toggleOnThisPage();"><i class="fas fa-chevron-down"></i></span></div>
		</div>
		<div class="m-onthispageexpand hide">
			<div id="onthispagetitle">On this page</div>
			<div id="onthispage">
			</div>
		</div>
						<div class="languagebutton" onclick="displayLanguagePanel();">
							<span><i class="fas fa-globe"></i></span>
							<span class="languagedescription">English</span>
							<span class="languagechevron"><i class="fas fa-chevron-down"></i></span>
						</div>
	</div> <!-- end m-aside -->
	<div class="m-body">
		<div style="height:75px" class="m-body-placeholder">&nbsp;</div>
	<div class="m-main" id="m-main-home" data-name="Home" data-number="0">
		<div style="height:70dvh;width:100%;display:flex;justify-content: center;align-items:center">
			<div id="m-main-home-content">
				<div style="display:flex;justify-content: center;align-items: center">
					<div style="flex-basis:25%;padding-right:1rem"><img src="icon1024.webp" style="width:100%"></div>
					<div style="flex-basis:75%;border-bottom:1px solid white"><h1 style="margin:0;padding:0"><span style="font-size: 1.5rem;color: white;font-weight: bold">SimTIVA Manual <span style='opacity: 0.3;font-weight:normal'>v2.0</span></span></h1></div>
				</div>
				<div style="display:flex;justify-content: center;align-items: center">
					<div style="flex-basis: 25%"></div>
					<div style="flex-basis: 75%">
						<div id="welcomemessage">
							<p style="color:white;font-weight:bold;font-size:0.9rem">Welcome!</p>
							<h2 style="color:inherit;font-size:0.9rem;border:0;padding:0;margin:0;color:#eee">This is the user manual for <a href="https://simtiva.app" target="_blank">SimTIVA.app</a>, a web app to simulate target-controlled infusion (TCI).</h2><p style="color:#ddd;font-size:0.9rem">This manual contains 10 chapters: the first two chapters cover the basic functionalities to help you get started. We have translated the manual into multiple languages. Video tutorials are coming soon.</p>
						</div>
						<div class="startbutton" style="" onclick="getChapter(1)">
							<span><i class="fas fa-chevron-circle-right"></i></span>
							<span class="startdescription">START</span>
						</div>
						<div class="languagebutton" style="margin-top:40px" onclick="displayLanguagePanel();">
							<span><i class="fas fa-globe"></i></span>
							<span class="languagedescription">English</span>
							<span class="languagechevron"><i class="fas fa-chevron-down"></i></span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
		<div class="m-main" id="m-main-chapter1" data-name="Getting Started" data-number="1"> <!--start m-main-->
			<p class="m-h1">Getting Started</p>
			<section id="1-1" data-heading="Entering patient data">
				<div class="m-image-container">
					<img src="manualresources/ss-1-startscreen1.webp">
				</div>
				<p>On the first screen, you may enter patient characteristics and choose a model. According to the model, there may be different patient parameters that are required. On the top, you can choose between "Adult" and "Paediatric" modes. For opioids, you will be required to enter the dilution.</p>
			
			
				<p class="m-h3">Validation</p>
				<p>Data validation is applied to data input. BMI, weight-for-age & length-for-age are displayed where available, according to WHO definitions and Child Growth Standards. Extreme body habitus will invoke a warning prompt.</p>
			
			
				<p class="m-h3">Paediatric patient</p>
				<p>In the paediatric mode, additional features are provided:</p>
				<ul>
					<li>Unit of age: y/m/d</li>
					<li>Post-menstrual age: coparameter in Eleveld model - prematurity affects clearance in <6months</li>
					<li>Validation of weight with WHO Child Growth Standards</li>
					<li>Custom opioid dilution</li>
					<li>Age-dependent estimated BIS for Eleveld model</li>
				</ul>
				<p>Other features that exist on adult patients are also provided for the paediatric patient, e.g. complex mode and PD interaction of propofol-opioid.</p>
				<p>In the following video demo, propofol and remifentanil CET regimens are simulated in children. Remifentanil dilution can be customized.</p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">Paediatric <a href="https://twitter.com/hashtag/TIVA?src=hash&amp;ref_src=twsrc%5Etfw">#TIVA</a> with <a href="https://t.co/qLpMHjFA1Q">https://t.co/qLpMHjFA1Q</a> (1/3)<a href="https://t.co/KXov8b2dRM">https://t.co/KXov8b2dRM</a> has TCI functions specially designed for children, but not as an afterthought. In this video, propofol and remifentanil CET regimens are simulated. Remifentanil dilution can be customized. <a href="https://t.co/1jMePtz0kp">pic.twitter.com/1jMePtz0kp</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1705766533837046231?ref_src=twsrc%5Etfw">September 24, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
			</section>
			<section id="1-4" data-heading="Drugs and models">
				<p class="m-h2">Drugs and models</p>
				<p>The available models are: </p>
				<ul>
					<li>Propofol: Eleveld, Marsh, Schnider, Paedfusor</li>
					<li>Remifentanil: Minto, Eleveld</li>
					<li>Fentanyl: Shafer</li>
					<li>Alfentanil: Maitre</li>
					<li>Complex mode: to simulate the combination of propofol and opioids, select "Complex (Dual mode)" in "Model" on the first screen. This will allow you to enter data for propofol and opioid on the second screen.
				</ul>
			</section>
			<section id="1-5" data-heading="Mode selection">
				<p class="m-h2">Mode selection screen</p>
				<p>After selecting a model, you may choose one of four infusion modes, namely CP targeting, CE targeting, manual bolus & infusion, and intermittent bolus. These will be explained in detail in Chapter 2.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-1-startscreen2.webp">
				</div>
				<p>If you have selected "Complex (Dual mode)" in "Model" on first screen, you can customize your propofol and opioid information on the second screen. For example, the PK model and drug dilution can be entered.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-1-start-complex.webp">
				</div>
			</section>
			<section id="1-6" data-heading="Installation/Download">
				<p class="m-h2">Installation/Download</p>
					<p>Simtiva.app is a website that can function as a web application. This means that you may run it inside your web browser (Safari on iPhone, Chrome on Android, or other browsers on desktop), or you may choose to install it directly through your browser. Once it is installed, it adds an icon to your homescreen that acts as the shortcut to the app and it can also be used offline - without internet access. Demos for installation on iPhone and Android illustrated below:</p>
				<p class="m-h3">iPhone iOS Safari:</p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">Did you know...?<a href="https://t.co/KXov8b2dRM">https://t.co/KXov8b2dRM</a> is a progressive web app (PWA). It can function like any other webpage on your browser on mobiles &amp; computers.<br><br>What&#39;s more, u can install it on your iPhone (see video/screenshot) by clicking share -&gt; add to homescreen.<a href="https://twitter.com/hashtag/TIVA?src=hash&amp;ref_src=twsrc%5Etfw">#TIVA</a> <a href="https://twitter.com/hashtag/TCI?src=hash&amp;ref_src=twsrc%5Etfw">#TCI</a> <a href="https://t.co/t5zCk67GY5">pic.twitter.com/t5zCk67GY5</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1725058259210649691?ref_src=twsrc%5Etfw">November 16, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
				<p class="m-h3">Android Chrome:</p>
				<p>Select "Install App" from the <span class="m-icon-inline"><i class="fas fa-ellipsis-v"></i></span> menu button.
				</p>
				<div class="m-image-container">
					<img src="manualresources/ss-1-install-android-chrome.jpg">
				</div>
			</section>
		</div>
		<div class="m-main" id="m-main-chapter2" data-name="Running Simulations" data-number="2">
			<p class="m-h1">Simulation modes</p>
			<section id="2-1" data-heading="Introduction">
				<p>There are 4 modes for single-drug simulation, namely CP targeting (plasma site targeting), CE targeting (effect site targeting), manual mode, or intermittent bolus mode. In addition there is a "Complex (Dual mode)" to simulate simultaneous infusions of propofol in combination with an opioid of your choice.</p>
				<p>The pharmacokinetic calculations are based on STANPUMP, created by Steven Shafer, freely available from opentci.org. Full credits and details available on "About" screen.</p>
				<p class="m-h3">Caution on accuracy</p>
				<p>Please note that SimTIVA is a computer simulation program only to simulate the delivery of TIVA using a TCI pump; but it has no physical connection interface with a syringe pump. SimTIVA is designed in a way such that the user is assumed to have multiple busy tasks at hand and may not be free to adjust pump settings very frequently (say every 10 seconds). In a TCI pump, the infusion rates are updated frequently, e.g. every 10 seconds. However, in SimTIVA, the concept is to simplify the infusion regimen so that the infusion rates need to be adjusted just several times per hour (definitely not every other second or minute), otherwise it will be too cumbersome for the anaesthetist looking after the patient to frequently alter the infusion rate on the pump. With this in mind, in CPT or CET mode, SimTIVA infusion regimen only requires you to change infusion rates for typically 5-7 times for the first hour or so. The downside of this is accuracy, SimTIVA will not be able to deliver a perfect CP/CE target because the CP/CE will fluctuate if the infusion rates are not adjusted very frequently. </p>
				<p class="m-h3">Realtime simulation</p>
				<p>SimTIVA is designed to run in real time, i.e. parallel to the actual time sequence of a clinical case. The clock (displayed on the top left corner) will start ticking the moment you start your simulation. For advanced feature in resetting the timeline, or going back partially or going forward in time, read Chapter 7 - Working with timeline.</p>
				<p class="m-h3">Overview of information display</p>
				<p>In all modes, the current CP and CE are displayed on top. A third box will also appear, indicating the infusion rate in ml/h, if an infusion is running. The main pharmacokinetic graph visualizes the plot of CP/CE values over time. If you are using the <span class="m-emphasis">Eleveld</span> propofol model, a box will appear below the main pharmacokinetic graph, showing the predicted bispectral index (BIS) value, which is estimated from the Eleveld pharmacodynamic model.</p>
				<p>For a more detailed walkthrough on using graphs in SimTIVA, proceed to Chapter 5: Working with Graphs.</p>
			</section>
			<section id="2-2" data-heading="CP Targeting">
				<p class="m-h2">CP Targeting mode (plasma site)</p>
				<p>In this mode, you can enter a CP target. For example, setting a propofol target CP of 3mcg/ml using the Marsh model will give rise to the following infusion regimen. The current CP, CE, and infusion rate will be displayed at the top of the screen. The suggested infusion CPT regimen is listed under "Scheme" to guide you through the next rate changes to maintain your desired target concentration. On mobile devices, you may need to swap between "Graph" and "Scheme" displays.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-cptmode.webp">
				</div>
				<p class="m-h3">Preview box</p>
				<p>As you enter your CP target, a blue box will appear, suggesting the action for you to follow. For example, a bolus followed by an infusion in ml/h. </p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-expand-hide.webp">
				</div>
				<p>You can click "Expand" to expand the preview box to a full preview, that will present to you the entire TCI scheme for the next few hours. Clicking "Hide" will collapse the box to its original state.</p>
				<p class="m-h3">Reminder box</p>
				<p>When the next infusion rate change is imminent, a red reminder box will remind you about it. If "Notification" and/or "Sound" in Options have been turned on, the prompts will appear at appropriate times (supported devices only). Please refer to Chpater 3 - Options. "Close" button will hide the reminder box prompt temporarily.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-warning.webp">
				</div>
			</section>
			<section id="2-3" data-heading="CE Targeting">
			<p class="m-h2">CE Targeting mode (effect site)</p>
				<p>In this mode, you can enter a CE target. Typically, the plasma concentration is allowed to overshoot to accomodate the fast achievement of CE towards target. Also, there is a pause after the initial bolus for CE to equilibrate with CP. For example, setting a propofol target CP of 3mcg/ml using the Eleveld model will give rise to the following infusion regimen. The current CP, CE, and infusion rate will be displayed at the top of the screen. The suggested infusion CET regimen is listed under "Scheme" to guide you through the next rate changes to maintain your desired target concentration. On mobile devices, you may need to swap between "Graph" and "Scheme" displays.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-cetmode.webp">
				</div>
				<p class="m-h3">Expanding the preview box</p>
				<p>As mentioned above, a preview box will appear as you enter a CE target. A practical tip is that you may expand the preview box by clicking "Expand" below the blue preview box to have a full understanding of the entire CET scheme before starting your infusion. Demo as below:</p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr"><a href="https://t.co/4zrK2ZezXO">https://t.co/4zrK2ZezXO</a> first update in 2024. User interface of CET and CPT modes has been re-designed. More importantly, a full preview of scheme is available (click “expand”) so you can preview the new scheme before submitting it. Other bugfixes in changelog. <a href="https://t.co/05hZqyiVJD">pic.twitter.com/05hZqyiVJD</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1748538694238384591?ref_src=twsrc%5Etfw">January 20, 2024</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
			</section>
			<section id="2-4" data-heading="Manual mode">
				<p class="m-h2">Manual mode</p>
				<p>In this mode, you can enter the bolus and infusion rate manually. The bolus input unit can be entered as ml, mg, or mg/kg for propofol, or ml, mcg, or mcg/kg for opioids. The infusion unit, similarly, can be configured on a volume, mass/time, or mass/body weight/time basis. You can change these units by clicking on the arrow <span style="padding: 4px; width: 2rem; background: #eee"><i class="fas fa-chevron-down"></i></span> next to the bolus/infusion input. The current CP, CE, and infusion rate will be displayed at the top of the screen.</p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">Wrapping up 2023 with a New feature (<a href="https://t.co/4zrK2ZezXO">https://t.co/4zrK2ZezXO</a>): Bolus &amp; Infusion units- U may now switch between “mg” vs “mg/kg” vs “ml” for bolus, “ml/h” vs “mg/kg/h” (or appropriate units) for infusion in manual mode.<br>Can switch by tapping the dropdown 🔽 or via “Options”.<br>(1/2) <a href="https://t.co/hCthkRDMbO">pic.twitter.com/hCthkRDMbO</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1736365967851331753?ref_src=twsrc%5Etfw">December 17, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
			</section>
			<section id="2-5" data-heading="Intermittent bolus mode">
				<p class="m-h2">Intermittent bolus mode</p>
				<p>In this mode, a scheme of intermittent repeated boluses is generated to achieve and maintain a certain target effect site concentration. This is suitable in a setting, where there is no syringe pumps available, for example a short case in a remote location or in a low-resource environment. With the intermittent bolus mode, a series of repeated small manual boluses are generated, to simulate a target-controlled infusion as close as possible. The accuracy of the repeated intermittent bolus scheme is affecetd by the fluctuation of CE. Caution: this mode does not take into the account of adverse effects of administering boluses, especially in larger doses, for example, a drug such as remifentanil may not be suitable to be given in intermittent boluses due to side effects of bradycardia and apnoea.</p>
				<p>The bolus amount and time interval will vary according to the CE target as well as the anticipated level of fluctuation of CE - described as peak/trough levels in this app. The peak/trough levels represent the magnitude of fluctuation for Ce. For example, when set to ±5%, the Ce will reach a maximum of 105% of target and then drop to a minimum of 95% of target. At the trough level, another bolus will be administered, and the cycle repeats.</p>
				<p>Please see the example below, in a simulated patient, to achieve approximate CE target of 3mcg/ml using the Eleveld model for propofol:</p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-IBmode-1.webp">
				</div>
				<p>The information box will display a horizontal countdown bar as well as a timer to notify you of the next bolus amount.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-IBmode-2-countdown.webp">
				</div>
				<p>The generated scheme will result in a pharmacokinetic graph like the following. Note the fluctuation in CE in response to repeated boluses; within the preset margins of ±5% in this example. The CP values will fluctuate widely.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-IBmode-3-graph.webp">
				</div>
				<p>The scheme to achieve and maintain CE target of 3mcg/ml is given below.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-IBmode-4-scheme.webp">
				</div>
				<p>When the next bolus is about to be delivered, a warning prompt will appear to remind you of an upcoming bolus. The bolus amount will also flash on the top display box.</p> 
				<div class="m-image-container">
					<img src="manualresources/ss-2-IBmode-5-prompt.webp">
				</div>
			</section>
			<section id="2-6" data-heading="Complex mode">
				<p class="m-h2">Complex (Dual) mode</p>
				<p>In this mode, you may run two-drug simulations simultaneously. For each drug, the functions for CP or CE targeting, manual infusion, or intermittent bolus mode are preserved. In addition, you may explore the pharmacodynamic (PD) interaction between propofol and opioid, as propofol and opioid demonstrate intense synergism. Probability of tolerance to laryngoscopy (PTOL) is used as a measure of potency of propofol-opioid combination. Isobologram charts illustrate the propofol-opioid combinations to achieve the same pharmacodynamic effect.</p>
				<p><b>For details, please read Chapter 8: Complex mode</b></p>
				<p>Isobologram: Using different combinations of CE-propofol and CE-remifentanil (effect-site concentrations of propofol and remifentanil respectively), all yielding the same predicted response (90% probability to tolerate laryngoscopy, PTOL90), a line (isobole) is drawn connecting all the possible combinations of CE-propofol/CE-remifentanil to achieve the same identical effect (van den Berg 2021). In our simulation programme, the same method is repeated for PTOL80, PTOL70... PTOL10 to generate a total of 9 isoboles on the 2-dimensional chart. The contour of the isoboles is typical of synergism, or supradditive interaction.</p>
				<p>For the opioid, you may choose to use remifentanil, fentanyl, or alfentanil. The program converts the CE into equivalent doses.</p>
				<p>Below is a video demostration of complex mode, with manual infusions of propofol and remifentanil. </p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">(4/5) <br>When is anaesthedia &quot;too deep&quot; or &quot;too light&quot;? <a href="https://t.co/KXov8b2dRM">https://t.co/KXov8b2dRM</a> enables PD modelling &amp; displays a &quot;green zone&quot; to mark the CE margins required to achieve PTOL50-90. In this example, CE is in the green zone but is predicted to fall below PTOL50 margin beyond 7.5min <a href="https://t.co/KJ0ICsQdeT">pic.twitter.com/KJ0ICsQdeT</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1702847358290280870?ref_src=twsrc%5Etfw">September 16, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
			</section>

		</div><!--end m-main (ch2)-->
		<div class="m-main" id="m-main-chapter3" data-name="Advanced Features" data-number="3">
			<p class="m-h1">Advanced Features</p>
			<section id="3-1" data-heading="Introduction">
				<p>This chapter will cover the following advanced features:</p>
				<ul>
					<li><b>Retrospective:</b> Entering bolus or infusion data retrospectively</li>
					<li><b>Volume estimation:</b> Compute the volume required for a given duration</li>
					<li><b>Time estimation:</b> Compute how long the infusion is going to last given a volume-to-be-infused</li>
					<li><b>Wakeup time:</b> Decrement time to a certain wakeup concentration</li>
					<li><b>Eleveld emulation:</b> For Marsh or Schnider models for propofol, SimTIVA can emulate Eleveld model using the infusion profile from a Marsh or Schnider infusion regimen.
				</ul>
			</section>
			<section id="3-2" data-heading="Advanced features">
				<p class="m-h2">Advanced Features</p>
				<p class="m-h3">Retrospective</p>
				<p>This feature allows you to retrospectively edit a manual bolus and infusion rate change. For example, the patient had surgical stimulation a few minutes ago, and you have given a manual bolus (25mg propofol) and adjusted the infusion rate to 60ml/h but you have forgotten to enter these information in SimTIVA, you can correct this in SimTIVA by using the Retrospective Function. Enter the information as in the picture below. A warning prompt will appear asking you to confirm the data. After this action, you are reminded to enter a new CP or CE target as soon as possible to continue with TCI functionality.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-retrospective.webp">
				</div>
				<p class="m-h3">Volume Estimation</p>
				<p>SimTIVA is running and you estimate the remaining surgery will take 30 minutes. How much propofol do you still need? The "Volume Estimation" panel will provide an answer, so that you will know if there is enough propofol in the syringe you are infusing, or how much more is required to be drawn up to avoid wastage.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-volumeestimation.webp">
				</div>
				<p class="m-h3">Time Estimation</p>
				<p>SimTIVA is running and you have a certain amount of propofol in the syringe that is currently being infused (e.g. 20mls remaining). Given the volume to be infused, what is the expected duration before this infusion is finished? The "Time Estimation" panel will provide an answer.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-timeestimation.webp">
				</div>
				<p class="m-h3">Wakeup Time</p>
				<p>This panel is based on decrement time from the current CE to drop to the designated "wakeup concentration" if the infusion is stopped at the current time point. Please note the patient characteristics, concurrent medications, duration of infusion etc all have an effect on wake-up time. </p>
				<div class="m-image-container">
					<img src="manualresources/ss-2-wakeuptime.webp">
				</div>
			</section>
			<section id="3-3" data-heading="Eleveld emulation">
				<p class="m-h2">Eleveld Emulation</p>
				<p class="m-h3">Purpose</p>
				<p>The purpose of this tool is to emulate Eleveld model by using an infusion profile generated from Marsh and Schnider TCI models. This way, you may use an existing TCI syringe pump programmed with these existing models and convert it into CP, CE, and estimated BIS in real time. You may also compare the older models (Marsh/Schnider) with the newer generation Eleveld model through the simulation graph.</p>
				<p>The advantages of using Eleveld model include:</p>
				<p>(1) <b>Allometric scaling</b>: by using fat-free mass, the model automatically corrects for obesity. This avoids dosing errors such as using actual body weight in Schnider model, which can lead to erroneously high infusion rates because of usage of James formula for calculating lean body mass in Schnider model.</p>
				<p>(2) <b>Prediction of BIS</b>: from its large dataset of over 1,000 patients with BIS measurements, a calibration curve is provided, to convert CE to an estimated BIS. In a validation study, the estimated BIS was found to be accurate.</p>
				<p>In view of the above, the Eleveld emulation tool can help anaesthetists to understand the Eleveld model better by deriving infusion data from a model they are more familiar with (Marsh or Schnider) and convert it into CP, CE, and estimated BIS values calculated from the Eleveld model. Using the graph provided, by moving the cursor over the time axis, you can learn about the differences between the models.</p>
				<p>Prerequisites: you must provide age, body weight and body height, and choose either Marsh or Schnider models on the input screen. Complex mode is not supported at this time.</p>
				<p><b>Note about obesity</b>: you should enter the actual body weight on the first screen. If severe obesity is detected (BMI>=35), you may be prompted to use adjusted body weight (Adj.BW) instead of total body weight (TBW) to improve model performance of Marsh/Schnider (Cortinez 2014). You can choose to use Adj.BW as suggested. The Eleveld emulation will then be based on TBW because Eleveld model does not require body weight adjustment, but the Marsh/Schnider model will be based on Adj.BW. So, in this scenario, you will be comparing between a Marsh/Schnider-Adj.BW model with an Eleveld-TBW model.</p>
				<p class="m-h3">Demonstration 1 - Normal body weight, Marsh</p>
				<p>Suppose we enter these patient characteristics: Marsh-CP targeting for a 50-year-old, 70kg, 170cm man. In the bottom of the main graph, there is the Eleveld emulation module. Click "Turn On Emulation" to begin.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-3a-emulationturnon.webp">
				</div>
				<p>A table will be provided to help convert a Marsh-CP target to an Eleveld-CE target. A ratio for conversion will be provided. This ratio is to guide the delivery of an Eleveld CE target at steady state. The table provides "Induction" and "Maintenence" targets, where "Induction" target should be used for the initial 1-3minutes while the Marsh CP target should be dropped to "Maintenence" target afterwards. The emulation graph will show you more details of how the Eleveld CP, CE change over time. Click "Start Emulation" to proceed with the emulation tool. You may refer to this emulation target reference table at a later time, by clicking the "Details" button on the emulation graph.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-3a-emulationtable.webp">
				</div>
				<p>By setting a CPT of 4, the infusion regimen generated by a Marsh-CPT program is as follows. The emulation module will feed in this infusion profile into an Eleveld model and generate Eleveld CP, CE, and estimated BIS.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-3a-emulationinfusion.webp">
				</div>
				<p>BIS prediction: the estimated BIS will be shown on top of the emulation module. In this example, the initial CPT was set at 4mcg/ml, then reduced to 2.5mcg/ml at approximately 5mins. On the graph, by moving the cursor, you can also preview the estimated BIS at different times.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-3a-emulationgraph.webp">
				</div>
				<p>From the above graph, you can see that at around 30minutes, the Elevled predicted a CE level of 3.19mcg/ml, whereas Marsh model predicted a CE level of 2.54mcg/ml.</p>
				<p class="m-h3">Demonstration 2 - Obese patient, Marsh</p>
				<p>Like the example above, we used Simtiva emulation module to emulate Eleveld model from Marsh model. This time, the patient was an obese individual with BMI 41 (BW: 120kg, BH: 170cm). Please note that you should always enter the actual body weight into Simtiva app, the app will perform body weight adjustment for you. The app will prompt you to use "Adjusted body weight" to improve the performance of the model (when using Marsh). See "Allometric Scaling" and "Note on obesity" above for more background details.</p>
				<p>Please watch the video below.</p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">Using adjusted BW can improve performance of Marsh model in severely obese. Using Eleveld emulation in <a href="https://t.co/4zrK2ZezXO">https://t.co/4zrK2ZezXO</a>, you can visualize the emulated Eleveld Cp/Ce when running an adj-BW Marsh infusion regimen. <a href="https://t.co/qVdwTCq0yb">pic.twitter.com/qVdwTCq0yb</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1801509344862998616?ref_src=twsrc%5Etfw">June 14, 2024</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
				<p>In this example, "Adjusted body weight" was used. The app will use adjusted body weight for calculation of Marsh model, and total body weight for calculation of Eleveld model.</p>
				<p>A CP target of 6.1mcg/ml was chosen for induction. This approximates an Eleveld CE target of 3mcg/ml. Follow the infusion regimen suggested, and then later reduce the CP target to the maintenance target.</p>
				<p class="m-h3">Example 3 - Obese patient using Schnider as an example</p>
				<p>It is challenging to use the older TCI models in severely obese. As mentioned above, because of incorporation of James formula in calculating lean body mass in Schnider model, the infusion rate will be erroneously high because of a spuriously high clearance calculated. Hence, it is safer to use Adjusted body weight in the Schnider model. After entering the actual body weight into Simtiva, severe obesity is detected, and adjusted body weight is recommended. </p>
				<div class="m-image-container">
					<img src="manualresources/ss-3a-schniderobese1.webp">
				</div>
				<p>Combining body weight adjustment feature with Eleveld emulation feature, we can compare the performance of using Adj.BW-Schnider with TBW-Eleveld in real time, as illustrated below. Schnider CE target was set at 4.5mcg/ml in this example. Corresponding Eleveld parameters such as Eleveld CE and eBIS will be displayed accordingly.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-3a-schniderobese2.webp">
				</div>
				<p>Reference: Performance of propofol target-controlled infusion models in the obese: pharmacokinetic and pharmacodynamic analysis, Anesth Analg, Cortinez 2014.<a href="https://pubmed.ncbi.nlm.nih.gov/24977639/">https://pubmed.ncbi.nlm.nih.gov/24977639/</a></p>
			</section>
		</div><!--end m-main (ch3)-->
		<div class="m-main" id="m-main-chapter4" data-name="Options" data-number="4">
			<p class="m-h1">OPTIONS</p>
			<section id="4-1" data-heading="Changing options">
				<p>SimTIVA settings can be accessed on the welcome screen by clicking the <span style="display: inline-block; padding: 4px; width: 1.8rem; height: 1.8rem; background: #ddd; border-radius: 2rem"><i class="fas fa-cog fa-fw"></i></span> options button. Alternatively, you may change the options when simulation is running, by going to the options panel at the bottom of the page.</p>
				<p class="m-h3">Dark mode</p>
				<p>You can switch between Dark / Light modes by clicking on the floating icon <span style="display: inline-block; padding: 4px; width: 1.8rem; height: 1.8rem; background: #ddd; border-radius: 2rem"><i class='fas fa-adjust fa-fw'></i></span> / <span style="display: inline-block; padding: 4px; width: 1.8rem; height: 1.8rem; background: #ddd; border-radius: 2rem"><i class="fas fa-moon fa-fw"></i></span> at the right lower corner.</p>
				<p class="m-h3">Saving options</p>
				<p>All options are automatically saved, so that the next time you use SimTIVA the same settings are restored.</p>
			</section>
			<section id="4-2" data-heading="List of options">
				<p class="m-h2">List of options</p>
				<p>The options panel:</p>
				<div class="m-image-container">
					<img src="manualresources/ss-3-options.webp">
				</div>
				<p><span class="m-emphasis">Unit:</span> the preferred secondary unit for propofol infusion. The primary unit is always ml/h. The secondary unit is used in prompts, reminders and schemes. An example is 50ml/h (10mg/kg/h). The US convention for propofol infusion is mcg/kg/m and you can change this unit here.</p>
				<p><span class="m-emphasis">Default rate unit:</span> this is the default rate unit for infusion in manual mode. You can switch between "ml/h" or "mg/kg/h", or appropriate units. This will not affect other modes, such as the CP/CE targeting mode. A video demo is shown below.</p>
				<p><span class="m-emphasis">Default bolus unit:</span> this is the default bolus unit for manual bolus in manual mode. You can switch between "ml", "mg", or "mg/kg" (or appropriate units).</p>
				<p><span class="m-emphasis">Simspeed:</span> the default is 1x (normal speed), and you can change it to 5x, 25x, or 50x, which will speed up the simulation.</p>
				<p><span class="m-emphasis">Threshold:</span> there are three options for the threshold/accuracy option: "Auto", "Lazy", or "Accurate". For CP/CE targeting, SimTIVA generates an infusion scheme to maintain the CP (or CE) approximately equal to the target. "Auto" threshold means that the program automatically determines the optimal balance between accuracy in maintaining the CP (or CE) while keeping the number of rate changes of the infusion scheme as infrequent as possible. "Lazy" means that the program will sacrifice accuracy of maintaining the target by keeping the number of infusion rate changes over time to a minimum. "Accurate" threshold setting will keep CP (or CE) value as close to target as possible, but this may increase the number of times you adjust the infusion rate in a CP/CE targeting scheme.</p>
				<P><span class="m-emphasis">Wakelock:</span> on a supported device, such as an Android device, setting Wakelock to "On" will keep the screen awake. If you are using iPhone, you may have to adjust the screen timeout in system preferences yourself.</p>
				<p><span class="m-emphasis">Vibrate:</span> when the next rate change is imminent in CP/CE targeting mode, SimTIVA will activate vibration as a reminder (supported devices only).</p>
				<p><span class="m-emphasis">Sound:</span> when the next rate change is imminent in CP/CE targeting mode, SimTIVA will sound an audio alarm (supported devices only).</p>
				<p><span class="m-emphasis">Notifications:</span> when the next rate change is imminent in CP/CE targeting mode, SimTIVA will activate system notification (supported devices only).</p>
			</section>
			<section id="4-3" data-heading="Infusion unit in manual mode">
				<p class="m-h3">Infusion unit in manual mode</p>
				<p>This is a video demo of altering the infusion and bolus units. You can also click the <span class="m-icon-inline"><i class="fas fa-chevron-down"></i></span> dropdown triangle next to the "Infusion rate" or "Bolus" entry fields to change these units. The conversion between ml/h and mg/kg/h is automatic.</p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">Wrapping up 2023 with a New feature (<a href="https://t.co/4zrK2ZezXO">https://t.co/4zrK2ZezXO</a>): Bolus &amp; Infusion units- U may now switch between “mg” vs “mg/kg” vs “ml” for bolus, “ml/h” vs “mg/kg/h” (or appropriate units) for infusion in manual mode.<br>Can switch by tapping the dropdown 🔽 or via “Options”.<br>(1/2) <a href="https://t.co/hCthkRDMbO">pic.twitter.com/hCthkRDMbO</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1736365967851331753?ref_src=twsrc%5Etfw">December 17, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
			</section>
		</div><!--end m-main (ch4)-->
		<div class="m-main" id="m-main-chapter5" data-name="Working with Graphs" data-number="5">
			<p class="m-h1">Working with graphs</p>
			<section id="5-1" data-heading="Overview">
				<p class="m-h2">Overview</p>
				<p>On mobile devices, the main graph looks like this:</p>
				<div class="m-image-container">
					<img src="manualresources/ss-4-maingraph-annotated.webp">
				</div>
				<ol type="A">
					<li><span class="m-emphasis">History/Scheme button:</span> shows "History" in manual mode and "Scheme" in CPT/CET mode</li>
					<li><span class="m-emphasis">Event button:</span> Annotate event at current time. You can edit the time and event details later on. Events are numbered and displayed at bottom of graph.</li>
					<li><span class="m-emphasis">Fullscreen button:</span> maximizes the graph and hides controls.</li>
					<li><span class="m-emphasis">Graph options button:</span> Opens the options panel - you can adjust the time scale among other options. The <span class="m-icon-inline"><i class="fas fa-search-plus"></i></span> and <span class="m-icon-inline"><i class="fas fa-search-minus"></i></span> buttons will change the time scale to show the entire timeline or just the current portion.</li>
				</ol>
			</section>
			<section id="5-2" data-heading="Quick view & time scale">
				<p class="m-h2">Video demo of quick view info box</p>
				<p>In this video demonstration, you can see that an info box appears in the main graph as move your cursor. (On mobile devices this means tapping on graph area, on desktop computers this means hovering over the graph area with mouse.) By highlighting a certain timepoint, the info box will display important data such as CP, CE, infusion rate, and estimated BIS (available in Eleveld propofol model only). This video also shows how you can adjust the time scale to show more (or less) of the timeline.
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/tiva?src=hash&amp;ref_src=twsrc%5Etfw">#tiva</a> <a href="https://twitter.com/hashtag/tci?src=hash&amp;ref_src=twsrc%5Etfw">#tci</a> <a href="https://twitter.com/hashtag/anaesthesia?src=hash&amp;ref_src=twsrc%5Etfw">#anaesthesia</a><br>Showcasing the updated feature of <a href="https://t.co/qLpMHjFA1Q">https://t.co/qLpMHjFA1Q</a> - using Eleveld model, an estimated BIS value is displayed. The chart also shows the CE boundaries for BIS 40-60. This allows estimation of effect without pEEG.<br>Chart duration also extends to 2h. <a href="https://t.co/i6O9ITw7vv">pic.twitter.com/i6O9ITw7vv</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1701062106144190782?ref_src=twsrc%5Etfw">September 11, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
			</section>
			<section id="5-3" data-heading="Graph options panel">
				<p class="m-h2">Graph options panel</p>
				<p>To open this panel, click the <span class="m-icon-inline"><i class="fas fa-cog"></i></span> icon. </p>
				<div class="m-image-container">
					<img src="manualresources/ss-4-graphoptions.webp">
				</div>
				<ul>
					<li>Display events: toggle events on/off.</li>
					<li>Automatic time scale: the time scale (x-axis) will be automatically adjusted as time progresses.</li>
					<li>Custom time range slider: Use this to show more (or less) of the timeline. Adjusting this will turn off automating time scaling.</li>
					<li>PD effect estimation: In Eleveld propofol model, the display of BIS 40-60 margins appears. This is the range of CE values to achieve BIS 40-60. In Complex mode, 2 more options are available: "PTOL 50-90" or "NSRI 20-50" margin display.</li>
				</ul>

			</section>
			<section id="5-4" data-heading="Fullscreen graph">
				<p class="m-h2">Fullscreen graph</p>
				<p>Sometimes, it is advantageous to hold your mobile phone sideways and maximize the graph to fullscreen. In this fullscreen display mode, the user inputs and controls, such as setting the CP/CE target or manual bolus or infusion entry fields are hidden. The important data, such as CP, CE, and infusion rate will still be displayed, on right side of screen. In addition, grey bars will appear at the bottom of the fullscreen graph to visualize the infusion rate changes over time.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-4-fullscreen.webp">
				</div>
				<ol type="A">
					<li>Info box display toggle: show/hide the info box.</li>
					<li>Close button: exits fullscreen.</li>
					<li>Options button: alters the fullscreen graph settings.</li>
				</ol>
				<p class="m-h3">iPhones & other devices</p>
				<p>On iPhones, fullscreen mode will not automatically turn your display sideways/landscape. Please check to have auto-rotate on and turn your phone sideways. On Android, fullscreen mode is in landscape like watching a video. On most desktop browsers, fullscreen mode is supported meaning that the browser window containing the graph will be maximized.</p> 
				<p class="m-h3">Showing/hiding the info box</p>
				<p>An info box containing drug information is displayed by default, to show the time & infusion data. If this hinders your viewing experience or obscures your graph, you can tap on the side arrow toggle <span class="m-icon-inline"><i class="fas fa-chevron-circle-right"></i></span> to hide it. The image below is a fullscreen graph with hidden info box.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-4-fullscreen-noinfo.webp">
				</div>
			</section>
			<section id="5-5" data-heading="Isobologram graph">
				<p class="m-h2">Isobologram</p>
				<p>The isobologram graph will be explained in detail in Chapter 8: Complex Mode.</p>
				<p>An example of an isobologram, which explores the relationship (specifically, the pharmacodynamic synergistic interaction) between propofol and remifentanil, is shown below.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-7-isobologram.jpeg">
				</div>
			</section>
		</div><!-- end m-main (ch5)-->
		<div class="m-main" id="m-main-chapter6" data-name="Events" data-number="6">
			<p class="m-h1">Events</p>
			<section id="6-1" data-heading="Overview">
				<p>Events contain small segments of text, marked at a specific time, which help you to mark important events or information on the timeline. Examples of events you may enter are: "Induction", "Loss of consciousness", "Intubation", "Woke up", or vital signs that you can enter manually.</p>
				<p>This feature is helpful when you wish to review the case. By marking the time point, when you highlight the time using the "Quick View" feature of the graph, you can also note the CP, CE, and infusion rate at that specific time point. </p>
				<div class="m-image-container">
					<img src="manualresources/ss-5-overview.webp">
				</div>
				<p>An example is shown above. Note the CP, CE, and eBIS at the point of "Waking up". The timing of this event correlates with the time highlighted on "Quick View" box on the main graph. The CE was 1.77mcg/ml, eBIS was 65 at this time point.</p>
			</section>
			<section id="6-2" data-heading="Event creation & editing">
				<p class="m-h2">Event creation</p>
				<p>To create an event, tap the "Event button" on the main graph. This will take you to the event creation screen. You can set the time of the event.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-5-eventcreation.webp">
				</div>
				<p class="m-h2">Event editing</p>
				<p>The events will appear as "01", "02"... et cetera on the main graph. The respective text content will appear at the bottom of the main graph</p>
				<div class="m-image-container">
					<img src="manualresources/ss-5-eventedit.webp">
				</div>
				<p>To edit the event, click on either the event marker (e.g. "02") on the main graph, or tap the event text at the bottom.</p>
				<p>You can turn events on or off in the graph options panel, which can be accessed by the <span class="m-icon-inline"><i class="fas fa-cog"></i></span> options button.</p>
			</section>
		</div><!-- end m-main (ch6)-->
		<div class="m-main" id="m-main-chapter7" data-name="Working with Timeline" data-number="7">
			<p class="m-h1">Working with Timeline</p>
			<section id="7-1" data-heading="Overview">
				<p>SimTIVA is designed to be run in real-time, that is, in parallel to the time course of an actual clinical case. The clock starts to tick the moment the case has started, and the CP/CE displayed at the current time point will also be the predicted pharmacokinetic status at present. However, SimTIVA also offers timeline functions as follows:</p>
				<ul>
					<li><span class="m-emphasis">Quick reset:</span>
						<br>Keep same patient data and start over from time zero</li>
					<li><span class="m-emphasis">Pause sim:</span>
						<br>Suspend simulation and keep all data, this is analagous to pausing a video playback</li>
					<li><span class="m-emphasis">Jump to time:</span>
						<br>Jump backward or forward in time, like skipping to different time point of a video</li>
				</ul>
				<p>The timeline functions are located in the "Control Panel" beneath the main graph.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-6-controlpanel.webp">
				</div>
				<p>Note that these functions will separate the simulation from working in real time, but may be advantageous in several situations. For example, you may wish to partially go back in time and try different dosing regimens by testing different infusion rates, or the effect of different doses of boluses. Or, you may have forgotten to start SimTIVA 5 minutes ago after you started actual clinical case, but you may still enter the infusion data into SimTIVA and jump forward 5 minutes and that would align the SimTIVA timeline to current time instance.</p>
				<p>For programming complexity reasons, the timeline functions are limited to CP/CE targeting and manual infusion mode of single-drug regimen only.</p>
			</section>
			<section id="7-2" data-heading="Jumping to time">
				<p class="m-h2">Jumping to time</p>
				<p>Opening the "Jump to time" window leads to one of the three options. You can move to a certain time point, or move back or move forward (relative to present). A time selection field is available. If the time entered is invalid, an error message will appear. Here is a video demo of the "Jump to time" feature: </p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">1/ Time travel<br>Upcoming feature: restart, pause sim, &amp; jump back/forward in time. SimTIVA is meant to be run in real-time, but this creates difficulty if u wish to simulate multiple scenarios, e.g. u may wish to start over or partially go back in time... <a href="https://t.co/vmF2NqFOlA">pic.twitter.com/vmF2NqFOlA</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1763109348262527467?ref_src=twsrc%5Etfw">February 29, 2024</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
				<p>This feature has a few limitations. One, all SimTIVA simulations have a limit of up to 6 hours. The pharmacokinetic data is generated for this finite duration, and you may not jump forward to beyond 6 hours after the last infusion scheme change.</p>
				<p>The other limitation is that, when going back partially in time, this will also remove any rate changes (or CP/CE target changes) along the way. If you have started your infusion, and changed the infusion rate from 50ml/h to 25ml/h at 30 minutes, and if you jump back from 1 hour (origin) to 10 minutes (destination), this will remove the infusion rate change at 30 minutes.</p>
			</section>
		</div><!--end m-main Ch7-->
		<div class="m-main" id="m-main-chapter8" data-name="Complex mode" data-number="8">
			<p class="m-h1">Complex Mode</p>
			<section id="8-1" data-heading="Introduction">
				<p class="m-h2">Introduction</p>
				<p class="m-h3">Entering the complex (dual) mode</p>
				<p>Complex (dual) mode enables the simultaneous simulations of 2 drugs: propofol and an opioid such as remifentanil, alfentanil, or fentanyl. </p>
				<div class="m-image-container">
					<img src="manualresources/ss-7-enteringcomplex.webp">
				</div>
				<ol type="A">
					<li>To enter this mode, choose "Complex (Dual mode)" under "Model" on the first screen</li>
					<li>Then, proceed to choose the appropriate model for Propofol, and the infusion mode as well</li>
					<li>Next, choose the opioid & model, its dilution, and the infusion mode. Click "Proceed" after you have finished.</li>
				</ol>
				<p class="m-h3">What is complex (dual) mode?</p>
				<p>This mode enables the simultaneous simulations of 2 drugs: propofol and an opioid such as remifentanil, alfentanil, or fentanyl. For each drug, the functions for CP or CE targeting, manual infusion, or intermittent bolus mode are preserved. Switching between two drug infusions is simple, each drug runs on its own under their respective tabs. See the tab interface below:</p>
				<div class="m-image-container">
					<img src="manualresources/ss-7-simultaneous.webp">
				</div>
				<ul>
					<li>Orange arrow: The active tab is "Propofol". This means that the current information displayed, including CP, CE, infusion rate, and the main graph, are all representing data for the propofol simulation.</li>
					<li>Purple arrow: When there is imminent change in the inactive tab, such as "Remifentanil" as demonstrated here, a reminder icon will appear next to the inactive tab. You may click the "Remifentanil" icon to switch to the "Remifentanil" simulation.</li>
					<li>Blue arrow: By clicking on the "Remifentanil" icon on the tab, you are now in the "Remifentanil" simulation. The information relevant to remifentanil will be displayed, such as the dilution and model, and other pharmacokinetic data.</li>
				</ul>
				<p>In addition, you may explore the pharmacodynamic (PD) interaction between propofol and opioid, as propofol and opioid demonstrate intense synergism. This will be further explained below. Probability of tolerance to laryngoscopy (PTOL) is used as a measure of potency of propofol-opioid combination. Isobologram charts illustrate the propofol-opioid combinations to achieve the same pharmacodynamic effect.</p>
				<p>The following are specific features of complex (dual) mode:</p>
				<ul>
					<li>In the main pharmacokinetic graph, a green zone will highlight the area bounded by the margins of PTOL50 and PTOL90. For example, in propofol simulation, the upper boundary of the green zone represents the CE-propofol to attain PTOL90, and the lower boundary of the green zone represents the CE-propofol to attain PTOL50.</li>
					<li>The current value of probability of tolerance to laryngoscopy will be shown in a box under the main graph. Screenshot is given below. Different options are available for this box display, namely: BIS, PTOL, and NSRI.</li>
					<li>An isobologram will be displayed. This shows the PTOL status (measure of mixed drug effects) in relation to CE-propofol and CE-opioid values, over time.</li>
				</ul>
				<div class="m-image-container">
					<img src="manualresources/ss-7-ptolswitching.webp">
				</div>
				<p>The above picture shows the display of the pharmacodynamic (PD) effect estimation mode of your choice. Three options are available: BIS, PTOL, and NSRI.</p>
				<ol type="A">
					<li>You can click the "Quick Switch" button (red arrow) to quickly cycle between BIS, PTOL, or NSRI displays.</li>
					<li>Alternatively, you can change this setting under "Graph options" by clicking on the <span class="m-icon-inline"><i class="fas fa-cog"></i></span> options icon then choose the appropriate PD effect estimation mode.</li>
					<li>The "green zone" on the main pharmacokinetic graph will update to show the margins for the upper and lower boundaries of PD effect, based on the PD estimation mode you have chosen. An example is PTOL50-90 (boundaries bounded by green arrows). This will be further explained.</li>
				</ol>

			</section>
			<section id="8-2" data-heading="Synergism">
				<p class="m-h2">Synergism</p>
				<p>Anaesthetists often combine medications to achieve accurate level of hypnosis and analgesia, with suppression of response to noxious stimulation. In total intravenous anaesthesia, propofol and opioids such as remifentanil demonstrate intense synergism. The interaction can be quantified using a hypnotic-analgesic endpoint such as ablating movement response to laryngoscopy. Bouillon and colleagues defined this as the probability to tolerate laryngoscopy, or PTOL. PTOL was suggested as an alternative to minimum alveolar concentration (MAC) when using propofol instead of volatile anaesthesia. For decades, the interaction between propofol and opioids has been studied using various clinical end-points, for example, algometry, tetanic stimulus, laryngoscopy and response to shaking and shouting (Kern 2004, Bouillon 2004). When studying the "response" to noxious stimulation, most contemporary anaesthetic depth monitors (which focus on hypnotic part of drug effect) and more recently developed analgesia monitors, were only partially successful in the correlation with response to noxious stimuli (Hannivoort 2016).</p>
				<p>For simplicity, SimTIVA has chosen PTOL as the measurement of choice to quantify the combined pharmacodynamic effect of propofol and opioids. This measurement is well studied in the literature to characterize the interaction between propofol-remifentanil, propofol-sevoflurane, and sevoflurane-remifentanil. Another related index, the noxious stimulation response index (NSRI), is a derivative of PTOL and a new numerical marker of depth of anaesthesia. The NSRI is scaled from 0 (indicating extensive combined drug effects) to 100 (when no anaesthetic medications are administered), and as NSRI is directly derived from PTOL using mathematical formula, NSRI and PTOL are therefore interchangeable, they merely differ in scale (Hannivoort 2016, Luginbuhl 2010). For PTOL, a PTOL of 100 means total absence of response to laryngoscopy. These measurements have been incorporated in drug information advisory displays on anaesthetic monitors. Both PTOL and NSRI can be displayed in SimTIVA as a marker of combined pharmacodynamic effect.</p>
				<p>A good method of visualizing the pharmacodynamic interaction behaviour of drug combinations is through response surface models, which show the entire spectrum of effect throughout different combinations of anaesthetic drug concentrations. Classically, if we are studying a specific level of effect, such as a 90% tolerance to laryngoscopy (PTOL90), we can use an isobologram, which can be derived from the more complex three-dimensional response surface model. Van den Berg studied the combinations of propofol and remifentanil to achieve predicted PTOL90, using the Bouillon interaction model, as described before. Using different combinations of CE-propofol and CE-remifentanil (effect-site concentrations of propofol and remifentanil respectively), all yielding the same predicted response (90% probability to tolerate laryngoscopy, PTOL90), a line (isobole) is drawn connecting all the possible combinations of CE-propofol/CE-remifentanil to achieve the same identical effect (van den Berg 2021). </p>
				<div class="m-image-container">
					<img src="manualresources/ss-7-vandenberg.webp">
				</div>
				<p>For example, 4 pairs of CE-propofol/CE-remifentanil are described to achieve this identical effect endpoint, as shown above. The clinician can then choose a particular combination that is most beneficial to different clinical scenario based on hypnotic, analgesic, and haemodynamic effects. The concept of "rational opioid selection" was also suggested by Vuyk in 1997, that using an opioid as an adjuvant of anaesthesia, the required propofol concentration can be reduced and this can possibly reduce the time of return to consciousness. Vuyk also described an optimal CE-opioid that can maintain adequate anaesthesia, while maintaining rapid wakeup through reduction in propofol requirements. In practice, the clinician may reduce propofol concentration and increase remifentanil concentration to hasten emergence from anaesthesia.</p>
				<p>The conversion of CE-remifentanil to two different opioids available in SimTIVA: CE-alfentanil and CE-fentanyl is based on opioid potency equivalence and the formula suggested by Vuyk, as given here: potency ratio of fentanyl:alfentanil:remifentanil was 1 : 1/70 : 1/2.3.</p>
			</section>
			<section id="8-3" data-heading="Isobologram">
				<p class="m-h2">Isobologram Interpretation</p>
				<p>The isobologram in SimTIVA contains 9 isoboles from PTOL10 to PTOL90. As mentioned before, using different combinations of CE-propofol and CE-remifentanil (effect-site concentrations of propofol and remifentanil respectively), all yielding the same predicted response (90% probability to tolerate laryngoscopy, PTOL90), a line (isobole) is drawn connecting all the possible combinations of CE-propofol/CE-remifentanil to achieve identical effect. The same method is repeated for PTOL80, PTOL70... PTOL10 to generate a total of 9 isoboles on the 2-dimensional chart. The contour of the isoboles is typical of synergism, or supradditive interaction.</p>
				<p class="m-h3">How to read the isobologram in SimTIVA</p>
				<ul>
					<li>X-axis: CE-opioid</li>
					<li>Y-axis: CE-propofol</li>
					<li>Red dot: Represents the current time instance - the x- and y- values are CE-opioid and CE-propofol respectively.</li>
					<li>Isobole lines: total of 9 isoboles displayed, the PTOL90, PTOL50 and PTOL10 lines are labelled for reference.</li>
					<li>PTOL trend line: A line representing the past, present, and future PTOL values over time of the current case. Every grey dot represent 1-minute intervals before and after current time.</li>
					<li>Arrow: PTOL value 20 minutes into the future.</li>
				</ul>
				<div class="m-image-container">
					<img src="manualresources/ss-7-isobologram.jpeg">
				</div>
				<p>In the above example, propofol 240mg bolus and remifentanil 50mcg bolus were given in an 80kg patient in a "dual mode" simulation. The resultant CE-propofol & CE-remifentanil values over time (the curved trend line) are plotted within this 2-dimensional space, overlapping on the isobole lines. The red dot represents the current time, with a PTOL of around 23%.</p>
			</section>
			<section id="8-4" data-heading="Examples">
				<p class="m-h2">Examples</p>
				<p class="m-h3">Example 1 - More propofol or more remifentanil for induction?</p>
				<p>To illustrate the application of "Complex (Dual mode)", the first example is given. Imagine a patient of 35 years old and 80kg body weight receiving propofol bolus and remifentanil bolus for induction. Two regimens are tested: </p>
				<div class="m-image-container">
					<img src="manualresources/ss-7-example1.webp">
				</div>
				<ul>
					<li>(A) Propofol 160mg and Remifentanil 100mcg</li>
					<li>(B) Propofol 240mg and Remifentanil 50mcg</li>
				</ul>
				<p>Both of these regimens can attain good intubating conditions (PTOL 90%) at 1m and 1.5m respectively. You can replicate the above scenarios using "Complex (Dual mode)", and select "Propofol-Eleveld" model and "Manual mode" as well as "Remifentanil-Minto" model and "Manual mode" in SimTIVA.</p>
				<p class="m-h3">Example 2 - Propofol and remifentanil infusions</p>
				<p>In this second example, propofol (Eleveld) and remifentanil (Minto) simulations were running in manual mode. Initially, BIS is chosen as PD effect estimation mode, and the green zone on the main graph of propofol simulation corresponds to CE required to achieve BIS 40-60. Then, the user has switched PD effect estimation to PTOL, which will also update the green zone on the main graph, which now highlights the CE values to attain PTOL50-90. In this example, because of falling remifentanil concentration post-induction, the PTOL was predicted to drop below 50% at around 7.5min. The anaesthetist should be aware of this and titrate the dosages accordingly to maintain adequate anaesthesia.</p>
				<p>Towards the end of the video demonstration, the isobologram is shown. The current PTOL value was represented by the red dot, and the past and future PTOL values were plotted as a trend line curve. The user then switched the PD effect estimation mode to NSRI, using the "Quick Switch" button.</p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">(4/5) <br>When is anaesthedia &quot;too deep&quot; or &quot;too light&quot;? <a href="https://t.co/KXov8b2dRM">https://t.co/KXov8b2dRM</a> enables PD modelling &amp; displays a &quot;green zone&quot; to mark the CE margins required to achieve PTOL50-90. In this example, CE is in the green zone but is predicted to fall below PTOL50 margin beyond 7.5min <a href="https://t.co/KJ0ICsQdeT">pic.twitter.com/KJ0ICsQdeT</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1702847358290280870?ref_src=twsrc%5Etfw">September 16, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
			</section>
		</div><!-- end m-main Ch8 -->
		<div class="m-main" id="m-main-chapter9" data-name="Share Function" data-number="9">
			<p class="m-h1">Share Function</p>
			<section id="9-0" data-heading="Introduction">
				<p class="m-h3">How to use the Share Function</p>
				<p>To open the "Share" panel, click the <span class="m-icon-inline"><i class="fas fa-share-alt fa-fw"></i></span> Share button (A) on the right lower corner. SimTIVA allows you to share your simulation in two ways. One, you can share a static image (B), which will contain the main pharmacokinetic graph, the infusion scheme, and events. Two, you can share an interactive SimFile (C) which can be viewed by the online SimTIVA Viewer; via this function, you can either share this SimFile as a website link (weblink for short) on desktop PCs or quickly share this directly on your mobile devices.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-8-sharefunction.webp">
				</div>
				<ol type="A">
					<li>Share button</li>
					<li>Share image (left side of panel)</li>
					<li>Share weblink (right side of panel)</li>
					<li>File name entry box</li>
				</ol>
				<p>You can also specify a "File Name" (D) to help identify this SimFile for record keeping. The same file name will be used as the SimFile saved locally on device, which you can later load and review - see next Chapter for details.</p>
			</section>
			<section id="9-1" data-heading="Share Image">
				<p class="m-h2">Share Image</p>
				<p>This function is ideal for visualizing an overview of your case or inserting it as an image for your presentations. As mentioned, this function generates a static image of the current simulation at the current time point (it automatically updates while SimTIVA is running). In the single-drug mode, a sample image is shown below. Aside from pharmacokinetic data, the File Name and the date and time of starting simulation will be displayed. You can choose to "Download" the image on desktop or mobile devices, or "Share" it on mobile devices. </p>
				<div class="m-image-container">
					<img src="manualresources/ss-8-shareimage.webp">
				</div>
				<p>For the Complex (Dual mode), both Propofol and Opioid simulations will be included. The isobologram will be displayed too. An isobologram legend guides the interpretation of the isobologram.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-8-shareimagedual.jpg">
				</div>
				<p class="m-h3">Share via Apps</p>
				<p>A convenient feature on mobile devices is that, you can use the "Share" button to share the image or weblink via the app of your choice. Screenshots of iPhone and Android (left and right respectively) are given below.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-8-shareapps.webp">
				</div>
			</section>
			<section id="9-2" data-heading="Weblink & SimTIVA Viewer">
				<p class="m-h2">Share Weblink & SimTIVA Viewer</p>
				<p>A copy of current simulation can be shared as a SimFile that can be viewed on the SimTIVA Viewer. All the data in the simulation becomes accessible on the weblink. Other users can then review the case interactively. A website link (weblink) is generated that functions as a SimFile.</p>
				<p>You may choose to "Copy" the weblink to clipboard and paste it in another program; or you can "Share" it via apps on mobile devices. In the video demonstration below, a weblink is shared via Whatsapp. Clicking on the link will load the SimFile automatically. The case was a surgery for excision of a lipoma, and the anaesthetic was sedation with propofol with fentanyl. The event notes can also be viewed. You can see from the video, the PK graph of propofol and the drug regimen given, and then you can also review the fentanyl graph and drug regimen. The PD effect estimation can be switched to BIS mode and the CP/CE/Infusion rate/eBIS can be reviewed by dragging the cursor over the main graph using the "Quick View" function. Finally, the Viewer app can go into Fullscreen for a general overview of the case.</p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">Did you know? <a href="https://t.co/4zrK2ZezXO">https://t.co/4zrK2ZezXO</a> has a &quot;share&quot; function that enables easy sharing of simulation. In this video, the case (excision of lipoma under propofol/fentanyl sedation) was shared via WhatsApp &amp; reviewed. Can see the CP/CE/inf/eBIS &amp; enter Fullscreen view for an… <a href="https://t.co/ziz6WudDGr">pic.twitter.com/ziz6WudDGr</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1778950923194397153?ref_src=twsrc%5Etfw">April 13, 2024</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
				<p>The weblink itself contains all the pharmacokinetic profile required to replay the entire simulation. The weblink to the above video is <a href="https://simtiva.app/view.html?P=N4IgdghgtgpiBcICiAPAxgSwM4YPZgAIQAaEABQH0AXDWBAJgEYBWR0ygBwhpjCoQDayADYwAbjGEATEuQBOuDrgBmuYSUYAGUlDQBzEgDYAnMUaHtAZgAcpAGIwoEUbKgGz2kAGUAFhGUwcrIOfBBgAJ7qZqRg7iC67myaAHTWjJYZjNYA7JaGacbZ9IYAuuwUMogALAD0jPQ19Jr0VQRa8PSW8MzGBACCALKylOKCApZVbCAAMn0gZQJV1p5eVBBy-Av1LaReHDCYsIS4AK5UBMkEXgBCZATZhvPEAkz02aQA6hAA1jAEMNcAJJeAiGR4lMrkCg+FBjATaJIeTQLbT0YjaZHPVHEPLEZiY+HRJhVDwo4ho4l4gkInH0NFaMloyx0qlktgZUwMrHknGWUz4xnEQxVQzEKrUnnGTSWMXMQX1Rjs6zy5g9dHywwZckS+nWVjqhaEthsehy7n09XmsXaAXc43ZTk6swO1l28nZWxcwkUj2u71CqqmcWCqWiqpm-0K5g45VWliGJIQyGUUSxKg+QRS-U5BMlAC+QA" target="_blank">here</a>.</p>
				<textarea style="width:100%;height:120px;font-size:0.75rem;background:#ddd">https://simtiva.app/view.html?P=N4IgdghgtgpiBcICiAPAxgSwM4YPZgAIQAaEABQH0AXDWBAJgEYBWR0ygBwhpjCoQDayADYwAbjGEATEuQBOuDrgBmuYSUYAGUlDQBzEgDYAnMUaHtAZgAcpAGIwoEUbKgGz2kAGUAFhGUwcrIOfBBgAJ7qZqRg7iC67myaAHTWjJYZjNYA7JaGacbZ9IYAuuwUMogALAD0jPQ19Jr0VQRa8PSW8MzGBACCALKylOKCApZVbCAAMn0gZQJV1p5eVBBy-Av1LaReHDCYsIS4AK5UBMkEXgBCZATZhvPEAkz02aQA6hAA1jAEMNcAJJeAiGR4lMrkCg+FBjATaJIeTQLbT0YjaZHPVHEPLEZiY+HRJhVDwo4ho4l4gkInH0NFaMloyx0qlktgZUwMrHknGWUz4xnEQxVQzEKrUnnGTSWMXMQX1Rjs6zy5g9dHywwZckS+nWVjqhaEthsehy7n09XmsXaAXc43ZTk6swO1l28nZWxcwkUj2u71CqqmcWCqWiqpm-0K5g45VWliGJIQyGUUSxKg+QRS-U5BMlAC+QA</textarea>
			</section>
		</div><!--end m-main Ch9 -->
		<div class="m-main" id="m-main-chapter10" data-name="File Management" data-number="10">
			<p class="m-h1">File Management</p>
			<section id="10-1" data-heading="Saving/Loading">
				<p class="m-h2">Saving/Loading SimFile</p>
				<p>First of all, it is worth noting that you do not need to do anything to save SimFile on device. SimTIVA is a web application and utilizes an interface called the "Local Storage API" to manage the simulations that you have run on your device. As you run a simulation, it is automatically saved.</p>
				<p>In the Share/Save panel, which can be easily accessed via the <span class="m-icon-inline"><i class="fas fa-share-alt fa-fw"></i></span> Share button, you can type a File Name for easy identification of the SimFile later on.</p>
				<p class="m-h3">The "Load File" panel</p>
				<p>Here is the appearance of the "Load File" Panel:</p>
				<div class="m-image-container">
					<img src="manualresources/ss-9-loadfile.webp">
				</div>
				<p>From the first screen, click <span class="m-icon-inline"><i class="fas fa-save fa-fw"></i></span> "Load File" (A), then click "Load Local SimFile" (B). This will take you to the "Load File" panel. A list of previously saved simulations will appear. Choose the desired SimFile and click "Load Selection". After loading, you can choose to "Resume Simulation", see the section below.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-9-loadfileinstructions.webp">
				</div>
				<p class="m-h3">Rescue (Rescuing the last-saved SimFile)</p>
				<p>Sometimes, accidents can happen. The browser window might have frozen or closed unexpectedly. By clicking <span class="m-icon-inline"><i class="fas fa-life-ring fa-fw"></i></span> "Rescue" on the first screen, the last-saved SimFile will be loaded and the data will be restored. Here you can resume from the last saved time point.</p>
			</section>
			<section id="10-2" data-heading="File Management">
				<p class="m-h2">File Management</p>
				<p class="m-h3">Deleting a SimFile</p>
				<p>In the "Load File" panel, click "Manage". Next to each SimFile item, there will be a <span class="m-icon-inline"><i class="fas fa-trash-alt"></i></span> Delete icon. Click it to delete a SimFile. Click "Exit Manager" to go back to the initial "Load File" panel.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-9-delete.webp">
				</div>
				<p class="m-h3">Exporting database</p>
				<p>The entire database of SimFiles can be exported. To perform this action, on the "Load File" Panel, click "Manage", and click "Export All". This will take you to the next screen, where you can enter a file name for the CSV database file, and once you confirm by clicking "Proceed" the file will be saved on to device.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-9-exportpopup.webp">
				</div>
				<p>This will generate a CSV file (comma-separated values). The database file can be opened by various spreadsheet programs such as Microsoft Excel or Google Sheets. In the database, each SimFile will be represented by the following data: file name (if any), time, duration, patient details such as age, weight and height, and a weblink attached to each SimFile entry. By opening the corresponding weblink of the case, this will take you to the SimTIVA Viewer app to review the case details.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-9-csv.webp">
				</div>
				<p>Also, the CSV file can be loaded into SimTIVA, so that you can use the SimTIVA app to retrieve the specific SimFile case for review. In the SimTIVA interface, it is possible to "Resume" from this previous case. See the sections below for details on how to load an external database CSV file and how to resume simulations.</p>
			</section>
			<section id="10-4" data-heading="Loading from external database">
				<p class="m-h2">Loading from external database</p>
				<p>Suppose a database is exported using the "Export" Function as outlined above. You will have the file saved on disk. It is possible to load this CSV file into SimTIVA and retrieve all the recorded SimFiles stored there. From the first screen, choose <span class="m-icon-inline"><i class="fas fa-save fa-fw"></i></span>  "Load File", and then "Import from external database". Use the file selection box to select the file on device to load. Select the desired SimFile entry and click "Load Selection". Watch the video below for a demonstration.</p>
				<div class="m-video-container">
					<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">December Updates (1)<a href="https://t.co/4zrK2ZezXO">https://t.co/4zrK2ZezXO</a> has improved its import/export function. U may export your data to a .CSV file &amp; import it back to SimTIVA from the Load screen. <br>U may also review individual simfiles by opening the .CSV file in a spreadsheet app. <a href="https://t.co/sVhgN3HLOm">pic.twitter.com/sVhgN3HLOm</a></p>&mdash; SimTIVA (@simtiva_app) <a href="https://twitter.com/simtiva_app/status/1732959336065081710?ref_src=twsrc%5Etfw">December 8, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
				</div>
			</section>
			<section id="10-5" data-heading="Resuming from SimFile">
				<p class="m-h2">Resuming from SimFile</p>
				<p>A SimFile can be loaded from three sources. One, by clicking "Rescue" on the initial screen and it will load the last-saved SimFile. Two, by loading from device locally. Three, by loading from external database. These are covered in the previous sections.</p>
				<p>After loading of the SimFile, you can view the data in the simulation such as CP/CE/Infusion scheme. You may also have the option to resume from the point when the simulation was suspended. You can enter the duration elapsed since the simulation was last suspended. You can continue with the case like a normal SimTIVA simulation.</p>
				<div class="m-image-container">
					<img src="manualresources/ss-9-resume.webp">
				</div>
			</section>
		</div><!--end of m-main Ch10 -->
		<!-- end of main content -->
		<div id="footer-up">
			<div id="footer-up-left">
				<div class="smalltext">Last updated:</div>
				<div id="lastupdated">24 Aug 2024</div>
			</div>
			<div id="footer-up-right" onclick="toTop();">
				<span style="border-radius: 2rem; width: 1.5rem;display:inline-block; margin-right:0.25rem"><i class="fas fa-chevron-circle-up"></i></span>TOP
			</div>
		</div>
		<div id="footer-down">
			<div id="footer-previous">
				<div class="smalltext"><i class="fas fa-chevron-circle-left"></i>&nbsp;Previous</div>
				<div id="previouschapter">...</div>
			</div>
			<div id="footer-next">
				<div class="smalltext">Next&nbsp;<i class="fas fa-chevron-circle-right"></i></div>
				<div id="nextchapter">...</div>
		</div>
	</div> <!--end m-body-->

		<div id="modalDialog" class="modal alt">
			<div class="modal-content alt" id="modalDialogcontent">
				<div class="modal-header alt"><span class="title">Please wait</span><span class="close alt" onClick="hidedialogmodal()">&times;</span></div>
				<div class="modal-body alt">SimTIVA is loading up...</div>
			</div>
		</div>
	<script>//start script block


//start service worker
if ("serviceWorker" in navigator) {
  window.addEventListener("load", function() {
    navigator.serviceWorker
      .register("/serviceworker.js")
      .then(res => console.log("service worker registered"))
      .catch(err => console.log("service worker not registered", err))
  })
}

//declare variables

languageMatrix = [
    [
        "English",
        "Anglais",
        "Inglés",
        "英文",
        "Inglês",
        "英語",
        "Английский"
    ],
    [
        "French",
        "Français",
        "Francés",
        "法语",
        "Francês",
        "フランス語",
        "Французский"
    ],
    [
        "Spanish",
        "Espagnol",
        "Español",
        "西班牙语",
        "Espanhol",
        "スペイン語",
        "испанский"
    ],
    [
        "Chinese",
        "Chinois",
        "Chino",
        "中文",
        "Chinês",
        "中国語",
        "Китайский"
    ],
    [
        "Portuguese",
        "Portugais",
        "Portugués",
        "葡萄牙语",
        "Português",
        "ポルトガル語",
        "Португальский"
    ],
    [
        "Japanese",
        "Japonais",
        "Japonés",
        "日语",
        "Japonês",
        "日本語",
        "Японский"
    ],
    [
        "Russian",
        "Russe",
        "Ruso",
        "俄语",
        "Russo",
        "ロシア語",
        "Русский"
    ]
];

mainObject = document.getElementById("m-main-chapter1");

activeChapter = 0;
activeLanguage = "en";

const sections = [...mainObject.querySelectorAll('[data-heading]')];

const DOWN = "DOWN";
const UP = "UP";

let prevScrollTop = 0;

const url = new URL(location);

let state = { chapter: 0, lang: "en"};

goHome();

setTimeout(function() {
	loadChapterURL();
	updateChapterListings();
	activateImageContainers();
},300);

function toTop() {
	window.scrollTo(0,0);
}

function getLangCode(input) {
	if (input == "en") return 0;
	if (input == "fr") return 1;
	if (input == "es") return 2;
	if (input == "zh") return 3;
}

function activateImageContainers() {
	document.querySelectorAll(".m-image-container > img").forEach(function(el) {
		el.setAttribute('onclick',`this.classList.toggle("expand")`)
	})
}

/*  obsolete ->
const callback = (entries, observer) => {
	entries.forEach((entry) =>
		console.log(entry))
}

const onIntersect = (entries) => {
	entries.forEach((entry) => {
		let string = entry.target.dataset.heading;
		console.log(string);
	})	
}
*/

function onObserve(entries) {
	entries.forEach((entry) => {
		const direction = calcScrollDirection();
		if (shouldUpdate(entry,direction)) {
			const target = direction === DOWN 
			? getNextSection(entry) 
			: entry.target;
			if (onThisPageArrayId.length>0) highlightOnThisPage(target.id);
			document.querySelector(".m-subheader-left").textContent = target.dataset.heading;
		} 
	})
}

const options = {
	//root: document.querySelector(".main"),
	rootMargin: '-100px 0px 0px 0px',
	threshold: 0
}

const observer = new IntersectionObserver(onObserve, options);

function calcScrollDirection() {
	const { scrollTop } = document.documentElement;
	const direction = prevScrollTop < scrollTop ? DOWN : UP;
	prevScrollTop = scrollTop;
	return direction;
}

function getNextSection(entry) {
	const index = sections.findIndex((section) =>
		section == entry.target);
	return sections[index + 1];
}

function shouldUpdate(entry, direction) {
	return (direction === DOWN && !entry.isIntersecting) || (direction === UP && entry.isIntersecting);
}

sections.forEach((section) => {
	observer.observe(section)
});

//hide all chapters
chapters = document.querySelectorAll(".m-main");

chapters.forEach((chapter) => {
	chapter.style.display = "none";
})

chapters[0].style.display = "block";
//end hide all chapters


function getChapter(number,omithistory,force) {
	if (activeChapter == 0) {
		if (number != 0) leaveHome();
	}
	if (number == 0) {
		if (activeChapter != 0) goHome();
	}
	if ((number != activeChapter) || (force==1)) {
		activeChapter = number;
		chapters = document.querySelectorAll(".m-main");
		chapters.forEach((chapter) => {
			chapter.style.display = "none";
		})
		mainObject = document.getElementById("m-main-chapter" + number);
		chapters[number].style.display = "block";
		if (number>0) {
			tempNodeList = [...mainObject.querySelectorAll('[data-heading]')];
			sections.length = 0;
			for (tempCount = 0; tempCount < tempNodeList.length; tempCount++) {
				sections.push(tempNodeList[tempCount]);
			}
			sections.forEach((section) => {
				observer.observe(section)
			});
			document.getElementById("chaptername").innerHTML = chapters[number].dataset.name;
			document.getElementById("chapternum").innerHTML = "Chapter " + chapters[number].dataset.number + ":";
		}
		updateOnThisPage();
		getFooter();
		if (omithistory != 1) {
			url.searchParams.set("ch", number);
			state.chapter = number;
			history.pushState(state, "", url);
		}
		toTop();
	}
}

window.addEventListener("popstate", (event) => {
	loadChapterURL();
});

let bodyElement = "";

	    	//backup the English body
	    	if ((activeLanguage == "en") && (bodyElement == "")) {
	    		bodyElement = {
	    			"chapter1": {},
	    			"chapter2": {},
	    			"chapter3": {},
	    			"chapter4": {},
	    			"chapter5": {},
	    			"chapter6": {},
	    			"chapter7": {},
	    			"chapter8": {},
	    			"chapter9": {},
	    			"chapter10": {},
	    		};
	    		for (count=1;count<=10;count++) {
	    			key = "chapter" + count;
	    			tempHTML = document.getElementById("m-main-" + key).outerHTML;
	    			bodyElement[key].text = JSON.stringify(tempHTML);
	    		}
	    	}

function loadChapterURL() {
	console.log("popstate event fired");
	tempString = window.location.search;
	tempParams = new URLSearchParams(tempString);
	file = "";
	parameter = tempParams.get("ch");
	parameter2 = tempParams.get("lang");
	if (parameter2 != undefined) {
		if (parameter2 != activeLanguage) {
			if (parameter2 == "zh") file = "zh";
			if (parameter2 == "es") file = "es";
			if (parameter2 == "fr") file = "fr";
			if (parameter2 == "pt") file = "pt";
			if (parameter2 == "ru") file = "ru";
			if (parameter2 == "ja") file = "ja";

			if (file != "") {
				if (parameter != undefined) {
					activeLanguage = parameter2;
					loadlanguage(file,parameter,1);
				} else {
					activeLanguage = "en";
					loadlanguage(file,0,1);
				}
			} else if ((file == "") || (file == "en")) {
				if (parameter != undefined) {
					if (parameter != activeChapter) {
						getChapter(parameter,1);
					}
				} else {
					getChapter(0,1);
				}
			} else {
				console.log("unacceptable language search param");
			}
		} else {
			//got "lang" in url, "lang" remains same
			if (parameter != undefined) {
				if (parameter != activeChapter) {
					getChapter(parameter,1);
				}
			} else {
				getChapter(0,1);
			}
		}
	} else {
		if (parameter != undefined) {
			if (parameter != activeChapter) {
				getChapter(parameter,1);
			}
		} else {
			getChapter(0,1);
		}
	}
}


let onThisPageArray = new Array();
let onThisPageArrayId = new Array();
let chapterListings = new Array();

function updateOnThisPage() {
	onThisPageArray.length = 0;
	onThisPageArrayId.length = 0;
	document.getElementById("onthispage").innerHTML = "";
	sections.forEach((section)=> {
    	onThisPageArray.push(section.dataset.heading);
    	onThisPageArrayId.push(section.id);
    });
    let El1 = document.createElement("ul");
	for (count=0;count<onThisPageArray.length;count++) {
    	let El2 = document.createElement("li");
    	let El3 = document.createElement("a");
    	El3.innerHTML = onThisPageArray[count];
    	El3.href = "#" + onThisPageArrayId[count];
    	El2.id = "link" + onThisPageArrayId[count];
    	El2.classList.add("onThisPageLink");
    	El3.setAttribute("onclick","document.getElementById('subheaderdropdown').classList.toggle('active');scrollby();document.querySelector('.m-onthispageexpand').classList.add('hide');");
    	El2.appendChild(El3);
    	El1.appendChild(El2);
	}
	document.getElementById("onthispage").appendChild(El1);
}

function highlightOnThisPage(inputID) {
	if (inputID != undefined) {
		let links = document.querySelectorAll(".onThisPageLink");
		links.forEach((link) => {
			link.classList.remove("active");
		});
		document.getElementById("link" + inputID).classList.add("active");
	}
}

function toggleOnThisPage() {
	document.getElementById("subheaderdropdown").classList.toggle("active");
	if (document.getElementById("subheaderdropdown").classList.contains("active")) {
		document.querySelector(".m-onthispageexpand").classList.remove("hide");
	} else {
		document.querySelector(".m-onthispageexpand").classList.add("hide");
	}
};

function updateChapterListings() {
	chapterListings.length = 0;
	document.querySelector(".menucontent").innerHTML = "";
	let El1 = document.createElement("ul");
	for (count=0; count<chapters.length; count++) {
    	let El2 = document.createElement("li");
    	let El3 = document.createElement("a");
    	if (count == 0) {
    		string = chapters[count].dataset.name;
    		El2.setAttribute("onclick", "getChapter(0); goHome(); togglemenu2();");
    	} else {
    		string = "<span style='color:white; width:2rem; display:inline-block'>" + chapters[count].dataset.number + ". " + "</span>" + chapters[count].dataset.name;
    		El2.setAttribute("onclick", "getChapter(" + count + "); togglemenu2();");
    	}
    	El3.innerHTML = string;
    	
    	El2.appendChild(El3);
    	El1.appendChild(El2);
		chapterListings.push(string);
	}
	document.querySelector(".menucontent").appendChild(El1);
}

function scrollby() {
	setTimeout(function() {window.scrollBy(0,-85);},100);
}
function togglemenu2() {
  document.getElementById("hamburgermanual").classList.toggle("change");
  if (document.getElementById("hamburgermanual").classList.contains("change")) {
    document.getElementById("menu2").classList.add("open");
  } else {
    document.getElementById("menu2").classList.remove("open");
  }

}

function loadlanguage(lang,ind,omithistory) {
	if ((lang=="fr") || (lang == "es") || (lang == "zh") || (lang == "pt") || (lang == "ru") || (lang == "ja")) {
		tempHTML = "";
		fetch(lang + '.json')
	  		.then(function(response) {
	    	return response.json();
	  	})
	  	.then(function(data) {

	    	//backup the English body
	    	if ((activeLanguage == "en") && (bodyElement == "")) {
	    		bodyElement = {
	    			"chapter1": {},
	    			"chapter2": {},
	    			"chapter3": {},
	    			"chapter4": {},
	    			"chapter5": {},
	    			"chapter6": {},
	    			"chapter7": {},
	    			"chapter8": {},
	    			"chapter9": {},
	    			"chapter10": {},
	    		};
	    		for (count=1;count<=10;count++) {
	    			key = "chapter" + count;
	    			tempHTML = document.getElementById("m-main-" + key).outerHTML;
	    			bodyElement[key].text = JSON.stringify(tempHTML);
	    		}
	    	}

	  		activeLanguage = lang;

			if (activeLanguage == "en") activeLanguageCode = 0;
			if (activeLanguage == "fr") activeLanguageCode = 1;
			if (activeLanguage == "es") activeLanguageCode = 2;
			if (activeLanguage == "zh") activeLanguageCode = 3;
			if (activeLanguage == "pt") activeLanguageCode = 4;
			if (activeLanguage == "ja") activeLanguageCode = 5;
			if (activeLanguage == "ru") activeLanguageCode = 6;

			//update the language buttons
			langButtons = document.querySelectorAll(".languagebutton");
			langButtons.forEach(function(langElement) {
				langElement.querySelector(".languagedescription").innerHTML = languageMatrix[activeLanguageCode][activeLanguageCode];
			})

			//update intro
			document.getElementById("welcomemessage").innerHTML = welcomeMessageArray[activeLanguageCode];

	  		for (count=1;count<=10;count++) {
	  			key2 = "chapter" + count;
	  			console.log(key2 + "loaded");
	  			if (data[key2] != undefined) {
	    			tempHTML=JSON.parse(data[key2].text);
	    			document.getElementById("m-main-" + key2).outerHTML = tempHTML;
	    		}
	    	}
	    	if (omithistory != undefined) {
	    		if (omithistory == 1) {
	    			getChapter(ind,1,1);
	    		} else {
	    			getChapter(ind,0,1);
	    		}	
	    	} else {
	    		getChapter(ind,0,1);
	    	}
			if (omithistory != 1) {
				url.searchParams.set("lang", lang);
				state.lang = lang;
				history.pushState(state, "", url);
			}
			activateImageContainers();
			updateChapterListings();
	    	twttr.widgets.load();


	  	});
	} else {
		//load the English version
		if (bodyElement != "") {
	  		for (count=1;count<=10;count++) {
	  			key = "chapter" + count;
	    		tempHTML=JSON.parse(bodyElement[key].text);
	    		document.getElementById("m-main-" + key).outerHTML = tempHTML;
	    	}
		}
		getChapter(ind,0,1);
		if (omithistory != 1) {
			url.searchParams.set("lang", lang);
			state.lang = lang;
			history.pushState(state, "", url);
		}
		setTimeout(function() {
			activateImageContainers();
			updateChapterListings();
	    	twttr.widgets.load();
	    },250);
		activeLanguage = "en";
		activeLanguageCode = 0;

			//update the language buttons
			langButtons = document.querySelectorAll(".languagebutton");
			langButtons.forEach(function(langElement) {
				langElement.querySelector(".languagedescription").innerHTML = languageMatrix[0][0];
			})

			document.getElementById("welcomemessage").innerHTML = welcomeMessageArray[0];
	}
}

function getFooter() {
	if ((activeChapter >= 1) && (activeChapter <= chapters.length-2)) {
		nextString = chapters[activeChapter*1+1].dataset.name;
		previousString = chapters[activeChapter*1-1].dataset.name;
		nextChapter = activeChapter*1 + 1;
		previousChapter = activeChapter*1 - 1;
		document.getElementById("footer-previous").style.visibility = "visible";
		document.getElementById("footer-next").style.visibility = "visible";
		document.getElementById("nextchapter").innerHTML = nextString;
		document.getElementById("previouschapter").innerHTML = previousString;
		document.getElementById("footer-previous").setAttribute("onclick","getChapter(" + previousChapter + ")");
		document.getElementById("footer-next").setAttribute("onclick","getChapter(" + nextChapter + ")");
	}
	if (activeChapter == 1) {
		nextString = chapters[activeChapter*1+1].dataset.name;
		nextChapter = activeChapter*1 + 1;
		document.getElementById("nextchapter").innerHTML = nextString;
		document.getElementById("footer-previous").style.visibility = "hidden";
		document.getElementById("footer-next").setAttribute("onclick","getChapter(" + nextChapter + ")");
	}
	if (activeChapter == chapters.length-1) {
		previousString = chapters[activeChapter*1-1].dataset.name;
		previousChapter = activeChapter*1-1;
		document.getElementById("previouschapter").innerHTML = previousString;
		document.getElementById("footer-next").style.visibility = "hidden";
		document.getElementById("footer-previous").setAttribute("onclick","getChapter(" + previousChapter + ")");
	}
}

activeLanguageCode = 0;
iterationArray = ["en","fr","es","zh","pt","ja","ru"];
disclaimerArray = [
	"Translation is performed using ChatGPT. ChatGPT can make mistakes. Please verify important information yourself.",
	"La traduction est effectuée à l'aide de ChatGPT. ChatGPT peut faire des erreurs. Veuillez vérifier vous-même les informations importantes.",
	"La traducción se realiza utilizando ChatGPT. ChatGPT puede cometer errores. Por favor, verifique usted mismo la información importante.",
	"翻译是使用 ChatGPT 进行的。ChatGPT 可能会犯错。请您自行验证重要信息。",
	"A tradução é feita usando o ChatGPT. O ChatGPT pode cometer erros. Por favor, verifique as informações importantes por si mesmo.",
	"翻訳は ChatGPT を使用して行われます。ChatGPT には間違いがある可能性があります。重要な情報は自分で確認してください。",
	"Перевод выполняется с использованием ChatGPT. ChatGPT может допускать ошибки. Пожалуйста, проверьте важную информацию самостоятельно."
]
welcomeMessageArray = [
	`<p style="color:white;font-weight:bold;font-size:0.9rem">Welcome!</p><h2 style="color:inherit;font-size:0.9rem;border:0;padding:0;margin:0;color:#eee">This is the user manual for <a href="https://simtiva.app" target="_blank">SimTIVA.app</a>, a web app to simulate target-controlled infusion (TCI).</h2><p style="color:#ddd;font-size:0.9rem">This manual contains 10 chapters: the first two chapters cover the basic functionalities to help you get started. We have translated the manual into multiple languages. Video tutorials are coming soon.</p>`,
	`<p style="color:white;font-weight:bold;font-size:0.9rem">Bienvenue !</p><h2 style="color:inherit;font-size:0.9rem;border:0;padding:0;margin:0;color:#eee">Il s'agit du manuel de l'utilisateur pour <a href="https://simtiva.app" target="_blank">SimTIVA.app</a>, une application web pour simuler l'infusion contrôlée par cible (TCI).</h2><p style="color:#ddd;font-size:0.9rem">Ce manuel contient 10 chapitres : les deux premiers chapitres couvrent les fonctionnalités de base pour vous aider à démarrer. Nous avons traduit le manuel en plusieurs langues. Des tutoriels vidéo seront bientôt disponibles.</p>`,
	`<p style="color:white;font-weight:bold;font-size:0.9rem">¡Bienvenido!</p><h2 style="color:inherit;font-size:0.9rem;border:0;padding:0;margin:0;color:#eee">Este es el manual del usuario para <a href="https://simtiva.app" target="_blank">SimTIVA.app</a>, una aplicación web para simular la infusión controlada por objetivo (TCI).</h2><p style="color:#ddd;font-size:0.9rem">Este manual contiene 10 capítulos: los dos primeros cubren las funcionalidades básicas para ayudarte a empezar. Hemos traducido el manual a varios idiomas. Pronto habrá tutoriales en vídeo.</p>`,
	`<p style="color:white;font-weight:bold;font-size:0.9rem">欢迎！</p><h2 style="color:inherit;font-size:0.9rem;border:0;padding:0;margin:0;color:#eee">这是 <a href="https://simtiva.app" target="_blank">SimTIVA.app</a> 的用户手册，一个用于模拟目标控制输注（TCI）的网络应用程序。</h2><p style="color:#ddd;font-size:0.9rem">本手册包含10个章节：前两章涵盖了基本功能，以帮助您快速入门。我们已将手册翻译成多种语言。视频教程即将推出。</p>`,
	`<p style="color:white;font-weight:bold;font-size:0.9rem">Bem-vindo!</p><h2 style="color:inherit;font-size:0.9rem;border:0;padding:0;margin:0;color:#eee">Este é o manual do usuário para <a href="https://simtiva.app" target="_blank">SimTIVA.app</a>, um aplicativo web para simular infusão controlada por alvo (TCI).</h2><p style="color:#ddd;font-size:0.9rem">Este manual contém 10 capítulos: os dois primeiros abordam as funcionalidades básicas para ajudá-lo a começar. Traduzimos o manual para vários idiomas. Vídeos tutoriais em breve.</p>`,
	`<p style="color:white;font-weight:bold;font-size:0.9rem">ようこそ！</p><h2 style="color:inherit;font-size:0.9rem;border:0;padding:0;margin:0;color:#eee">これは、<a href="https://simtiva.app" target="_blank">SimTIVA.app</a> のユーザーマニュアルです。これは、ターゲット制御インフュージョン（TCI）をシミュレートするためのWebアプリケーションです。</h2><p style="color:#ddd;font-size:0.9rem">このマニュアルには、10つの章が含まれています。最初の2つの章では、基本機能について説明し、始めるのに役立ちます。マニュアルは複数の言語に翻訳されています。ビデオチュートリアルは近日公開予定です。</p>`,
	`<p style="color:white;font-weight:bold;font-size:0.9rem">Добро пожаловать!</p><h2 style="color:inherit;font-size:0.9rem;border:0;padding:0;margin:0;color:#eee">Это руководство пользователя для <a href="https://simtiva.app" target="_blank">SimTIVA.app</a>, веб-приложения для симуляции инфузии с контролем по цели (TCI).</h2><p style="color:#ddd;font-size:0.9rem">Это руководство содержит 10 глав: первые две охватывают основные функции, чтобы помочь вам начать. Мы перевели руководство на несколько языков. Видеоуроки скоро.</p>`

]

function displayLanguagePanel() {
	if (activeLanguage == "en") activeLanguageCode = 0;
	if (activeLanguage == "fr") activeLanguageCode = 1;
	if (activeLanguage == "es") activeLanguageCode = 2;
	if (activeLanguage == "zh") activeLanguageCode = 3;
	if (activeLanguage == "pt") activeLanguageCode = 4;
	if (activeLanguage == "ja") activeLanguageCode = 5;
	if (activeLanguage == "ru") activeLanguageCode = 6;
	
	El1 = document.createElement("div");
	El1.classList.add("languagePanel");
	El1.innerHTML = "";
	for (iteration = 0; iteration<languageMatrix.length; iteration++) {
		El2 = document.createElement("div");
		El2.classList.add("lang-option");
		if (activeLanguage == iterationArray[iteration]) {
			El2.classList.add("lang-active");
		}
		//if (iteration>=4) {
		//	El2.classList.add("disabled");
		//}
		El2.innerHTML = "<div><span class='lang-text'>" + languageMatrix[iteration][iteration] + "</span><span class='lang-subtext'>" + languageMatrix[iteration][activeLanguageCode] + "</span></div>";
		El2.setAttribute("onclick","loadlanguage('" + iterationArray[iteration] + "'," + activeChapter + ");hidedialogmodal()");
		El1.appendChild(El2);
	}
	El3 = document.createElement("div");
	El3.innerHTML = disclaimerArray[activeLanguageCode];
	El3.classList.add("lang-disclaimer");
	ElRoot = document.createElement("div");
	ElRoot.appendChild(El1);
	ElRoot.appendChild(El3);
	displayDialog("Language",ElRoot.innerHTML);
}

modal = undefined;
function setmodal(modalname) {
  modal = document.getElementById(modalname);
  modalcontent = document.getElementById(modalname + "content");
  modal.classList.add("fadein");
  modalcontent.classList.add("open");
  //document.getElementById("bodywrapper").classList.add("blurry");
}

window.onclick = function(event) {
  if ((event.target == modal) && (modal.id != "modalInitial") && (modal.id != "modalScreen2") && (modal.id != "modalLoad")) {
    //document.getElementById("bodywrapper").classList.remove("blurry");

    if (modal.id == "modalShare") {
	  	clearInterval(canvasUpdateInterval);
	  	canvasUpdateInterval = null;
	  }

    modalcontent = document.getElementById(modal.id + "content");
    modal.classList.remove("fadein");
    modalcontent.classList.remove("open");
    modal = undefined;
    
  }
}
document.addEventListener('touchstart', function(event){
  if ((event.target == modal) && (modal.id != "modalInitial") && (modal.id != "modalScreen2") && (modal.id != "modalLoad")) {
    //document.getElementById("bodywrapper").classList.remove("blurry");

    if (modal.id == "modalShare") {
	  	clearInterval(canvasUpdateInterval);
	  	canvasUpdateInterval = null;
	  }
    modalcontent = document.getElementById(modal.id + "content");
    modal.classList.remove("fadein");
    modalcontent.classList.remove("open");
    modal = undefined;
    //document.getElementById("bodywrapper").classList.remove("blurry");
  }
});

function displayDialog(dialogTitle, dialogContent) {
	const ElTitle = document.querySelector("#modalDialog .title");
	const ElContent = document.querySelector("#modalDialog .modal-body");
	ElTitle.innerHTML = dialogTitle;
	ElContent.innerHTML = dialogContent;
	setmodal("modalDialog");
}
function hideallmodal() {
	//document.getElementById("bodywrapper").classList.remove("blurry");
	if (modal != undefined) {
	  if (modal.id == "modalShare") {
	  	clearInterval(canvasUpdateInterval);
	  	canvasUpdateInterval = null;
	  }
		modalcontent = document.getElementById(modal.id + "content");
	  modal.classList.remove("fadein");
	  modalcontent.classList.remove("open");
	  modal = undefined;

	}
}
function hidemodal(param) {
		if (param == "modalShare") {
	  	clearInterval(canvasUpdateInterval);
	  	canvasUpdateInterval = null;
	  }
	document.getElementById(param + "content").classList.remove("open");
	document.getElementById(param).classList.remove("fadein");
	modal = undefined;
}
function hidedialogmodal() {
  document.getElementById("modalDialog").classList.remove("fadein");
  document.getElementById("modalDialogcontent").classList.remove("open");
}

function goHome() {
	document.querySelector(".m-aside").style.display="none";
	document.querySelector(".m-body").classList.add("home");
	document.body.classList.add("home");
	document.getElementById("footer-up").classList.add("home");
	document.getElementById("footer-down").classList.add("home");
	document.getElementById("footer-previous").classList.add("home");
	document.getElementById("footer-next").classList.add("home");
}

function leaveHome() {
	document.querySelector(".m-aside").style.display="block";
	document.querySelector(".m-body").classList.remove("home");
	document.body.classList.remove("home");
	document.getElementById("footer-up").classList.remove("home");
	document.getElementById("footer-down").classList.remove("home");
	document.getElementById("footer-previous").classList.remove("home");
	document.getElementById("footer-next").classList.remove("home");
}


	</script><!--end of script block-->
	<script src="lz-string.js"></script>
	<script id="twitter-wjs" type="text/javascript" async defer src="//platform.twitter.com/widgets.js"></script>
</body>
</html>

